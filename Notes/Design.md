## Stellar design

Stellar is written in Swift and highly leverage [Swift Package Manager](https://www.swift.org/package-manager/) (SPM) and [Swift Argument Parser](https://github.com/apple/swift-argument-parser) (SAP).

The Stellar ecosystem is composed of 4 parts:

### Actions

Actions are the basic building blocks of the ecosystem. They are packages that define a library product. An action can do anything, from taking care of build tasks to integrating with GitHub. 

Actions are independent packages that have no knowledge of the Stellar system, which treats them as pluggable components to create higher abstractions.

Ideally, actions should expose an executable product (the CLI tool) using SAP calling into the action code. This is not required by Stellar but it’s advisable as a best practice.

Official Actions are hosted in the Stellar organisation on GitHub. Custom Actions can be created using Stellar.

### Tasks

Task are specific to a project and implemented by the project developers. They are SAP `ParsableCommand` or `AsyncParsableCommand` tall call into actions to construct chunk of work that are:

- specific to your project
- complex combination of Actions

### Executor

Executor is a command line tool in the form of package generated by Stellar. It’s the entry point to call your tasks.

### Stellar CLI

Stellar CLI is a command line tool that takes care of the heavy lifting of dealing with the Executor and the Tasks.

It allows integration of Stellar in your project with commands such as `init`, `edit`, `create-action`, `build`and `generate-documentation`.

## Similarities with other tools

Stellar Actions are similar to [Fastlane Actions](https://docs.fastlane.tools/actions/).

Stellar Task are similar to [Fastlane Lanes](https://docs.fastlane.tools/advanced/lanes/).

Invoking tasks on the Executor is like invoking lanes on Fastlane.

`stellar edit` is similar to `tuist edit`.

# Overall design

We believe that a combination of CLI tools can create complex, templatable and customizable stacks to support the creation and growth of iOS codebases.

The set of tools take the name of “Stellar Tools”.

- Tuist: generates projects and workspaces programmatically
- Muist*: generates packages using a DSL
- Stacker*: creates a modular iOS project based on a DSL
- Stellar*: automate tasks
- Workflows*: generates GitHub Actions workflows

* = name to be defined

[Graphviz Online](https://dreampuf.github.io/GraphvizOnline/)

```swift
digraph G {

  subgraph cluster_clients {
    CI
    User
    label="Consumers"
  }

  subgraph cluster_products {
    node [style=filled];
    Stellar;
    Stacker;
    label="Consumer Products"
    color=green
  }
  
  subgraph cluster_stacker {
    node [style=filled];
    Stacker -> Tuist;
    Stacker -> Muist;
    Muist -> PackageGenerator;
    label="Stacker internals"
    color=blue
  }

  subgraph cluster_stellar {
    node [style=filled];
    Stellar -> Executor;
    Executor -> "Task 1"
    Executor -> "Task 2"
    Executor -> "Task n"
    "Task 1" -> "Action 1"
    "Task 2" -> "Action 2"
    "Task n" -> "Action n"
    label="Stellar internals"
    color=purple
  }

  
  CI -> Executor;
  User -> Stellar;
  User -> Stacker;
  Stellar -> Templates [style=dotted];
  Stacker -> Templates [style=dotted];
  
  User [shape=oval];
  CI [shape=oval];
  
  Templates [shape=box];
  Stellar [shape=box];
  Stacker [shape=box];
  Tuist [shape=box];
  Muist [shape=box];
  Executor [shape=box];
  "Action 1" [shape=box];
  "Action 2" [shape=box];
  "Action n" [shape=box];
  PackageGenerator [shape=box];
}
```
